---
title: "ipm field retrieval BM25F"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## BM25F Analysis Tuning Boost Scheme Results
# This explore performance from tuning boost schema results using uniform b = 0.75 and K = 1.2

rm(list = ls())

# BM25F Load Trec eval results
```
trecEvalResult <- read.table("/Volumes/Data/Github/ipm2017_fielded_retrieval/data/evalBm25fTuneBoost_Hard2003.txt", header=TRUE, row.names=NULL)

trecEvalResult <- read.table("/Volumes/Data/Github/ipm2017_fielded_retrieval/data/evalBm25fTuneBoost_Hard2005.txt", header=TRUE, row.names=NULL)

trecEvalResult <- read.table("/Volumes/Data/Github/ipm2017_fielded_retrieval/data/evalBm25fTuneBoost_Web.txt", header=TRUE, row.names=NULL)

trecEvalResult <- read.table("/Volumes/Data/Github/ipm2017_fielded_retrieval/data/evalBm25fTuneBoost_Clef2016.txt", header=TRUE, row.names=NULL)



trecEvalResult$alpha = trecEvalResult$alpha/10

avgScores = aggregate(trecEvalResult[,4:8],list(trecEvalResult$schema, trecEvalResult$alpha), mean)
colnames(avgScores)[2] <- "alpha"
```

# UNIFIELD - Load Trec eval results from unifield index where title and body are merged as one field.
# this non-field based retrieval will be used as "baseline" 
```
defaultUniEvalResult <- read.table("/Volumes/Data/Github/ipm2017_fielded_retrieval/data/evalBm25fdefaultUnifield_Hard2003.txt", header=TRUE, row.names=NULL)

defaultUniAvgScores = aggregate(defaultUniEvalResult[,3:7],list(defaultUniEvalResult$schema), mean)

```

# General Chart Setup
```
lW = 2.5
w = 8
h = 6
outputPath = "/Volumes/Data/Github/ipm2017_fielded_retrieval/latex_irj/"
```

# Line Plot performance alpha
***** Lines/dot Plot
```
xrange <- range(as.numeric(avgScores$alpha))
yrange <- range(c(avgScores$p10, avgScores$ndcg10, avgScores$map, avgScores$bpref))

margin=c(3,3,1,1)
cols <- c("blue", "red", "green4", "orange")
ltys <- c(1,2,3,4)
pchs <- c(1,2,3,4)
lbls <- c("P@10","nDCG@10","MAP","BPREF")
par(mar=margin)
plot(xrange, yrange, type="n", xlab=NA, ylab=NA, axes=FALSE)

box(lty=1, col='black')
axis(side=1, at=avgScores$alpha)
axis(side=2, at=seq(round(min(yrange),3), round( max(yrange),3)+0.01,by=round((max(yrange)-min(yrange))/7,3)))

lines(avgScores$alpha, avgScores$p10, type="b", lwd=lW, lty=ltys[1], pch=1, col=cols[1])
lines(avgScores$alpha, avgScores$ndcg10, type="b", lwd=lW, lty=ltys[2], pch=2, col=cols[2])
lines(avgScores$alpha, avgScores$map, type="b", lwd=lW, lty=ltys[3], pch=3, col=cols[3])
lines(avgScores$alpha, avgScores$bpref, type="b", lwd=lW, lty=ltys[4], pch=4, col=cols[4])

mtext(side=1, expression(alpha), line=2, cex=1.7)
mtext(side=2, "Evaluation Score", line=2, cex=1.2)

legend(x=0.7, y=max(yrange)+0.01, legend=lbls, lty=ltys, pch=pchs, ncol=1, text.width= 1, col=cols, bty='n', lwd=lW, cex=1.2, xpd=TRUE,y.intersp=2, x.intersp=0.5)


legend("bottomleft", legend=lbls, lty=ltys, pch=pchs, ncol=1, text.width= 1, col=cols, bty='n', lwd=lW, cex=1.2, xpd=TRUE,y.intersp=2, x.intersp=0.5)
```

# UNIFIELD - add line to represent performance from unifield index
```
abline(h=defaultUniAvgScores$p10, lwd=lW, lty=ltys[1], col=cols[1])
abline(h=defaultUniAvgScores$ndcg10, lwd=lW, lty=ltys[2], col=cols[2])
abline(h=defaultUniAvgScores$map, lwd=lW, lty=ltys[3], col=cols[3])
abline(h=defaultUniAvgScores$bpref, lwd=lW, lty=ltys[4], col=cols[4])
```


# ***** BM25F Save Plot performance alpha
```
dev.copy(pdf,paste(outputPath, "bm25fByAlpha_Hard2003.pdf", sep=""), width=w, height=h)
dev.off()

dev.copy(pdf,paste(outputPath, "bm25fByAlpha_Hard2005.pdf", sep=""), width=w, height=h)
dev.off()

dev.copy(pdf,paste(outputPath, "bm25fByAlpha_Web.pdf", sep=""), width=w, height=h)
dev.off()

dev.copy(pdf,paste(outputPath, "bm25fByAlpha_Clef2016.pdf", sep=""), width=w, height=h)
dev.off()
```





## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
